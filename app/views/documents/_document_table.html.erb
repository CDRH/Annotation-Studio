<table class="table table-striped table-bordered">
  <tr>

    <% unless controller_name == "anthologies" %>
      <th>Anthologies<%= select_tag "anthology", options_from_collection_for_select(@anthologies, "id", "name") %> </th>
    <% end %>
    <th>Title</th>
    <th>Author</th>
    <th>Created</th>
    <th><%= ENV["CLASS_TERM_PLURAL"] %></th>
    <th>Status</th>
    <th>Actions</th>
  </tr>
  <% unless documents.nil? || documents.empty? %>
    <% documents.each do |document| %>
      <tr>
        <% unless controller_name == "anthologies" %>
          <% if document.anthology_id == Anthology.first.id %>
            <td><div class="<%= "document_of_#{document.id}" %>" ><%= check_box_tag 'document_ids[]', document.id,  :checked => "checked" %></div></td>
          <% end %>
          <% if document.anthology_id != Anthology.first.id %>
            <td><div class="<%= "document_of_#{document.id}"%>" ><%= check_box_tag 'document_ids[]',  document.id %></div></td>
          <% end %>
        <% end %>
        <td>
          <% if controller_name == 'anthologies' %>
            <%= link_to document.title, anthology_document_path(document.anthology.friendly_id, document.friendly_id) %></td>
      <% else %>
        <%= link_to document.title, document_path(document.friendly_id) %></td>
    <% end %>
    <td>
      <%= document.author %></td>
    <td>
      <%= document.created_at.strftime("%m/%d/%Y") %></td>
    <td>
      <% document.rep_group_list.each do |group| %>
        <span class="label label-info">
          <%= group %></span>
      <% end %></td>
    <td>
      <% if can? :update, document %>
        <div class="btn-group" role="group" aria-label="document states">

          <% if document.draft? %>
            <%= link_to 'Editable', "#", :class => 'btn btn-default btn-sm active' %>
          <% else %>
            <%= link_to 'Editable', "#", :class => 'btn btn-default btn-sm disabled' %>
          <% end %>


          <% if document.annotatable? %>
            <%= link_to 'Annotatable', document_annotatable_path(document), method: :post, :class => 'btn btn-default btn-sm active' %>
          <% else %>
            <%= link_to 'Annotatable', document_annotatable_path(document), method: :post, :class => 'btn btn-default btn-sm' %>
          <% end %>


          <% if document.review? %>
            <%= link_to 'Reviewable', document_review_path(document), method: :post, :class => 'btn btn-default btn-sm active' %>
          <% else %>
            <%= link_to 'Reviewable', document_review_path(document), method: :post, :class => 'btn btn-default btn-sm' %>
          <% end %>


          <% if document.published? %>
            <%= link_to 'Publishable', document_publish_path(document), method: :post, :class => 'btn btn-default btn-sm active' %>
          <% else %>
            <%= link_to 'Publishable', document_publish_path(document), method: :post, :class => 'btn btn-default btn-sm' %>
          <% end %>


          <% if document.archived? %>
            <%= link_to 'Hidden', document_archive_path(document), method: :post, :class => 'btn btn-default btn-sm active' %>
          <% else %>
            <%= link_to 'Hidden', document_archive_path(document), method: :post, :class => 'btn btn-default btn-sm' %>
          <% end %>
        </div>
      <% else %>
        <%= document.state %>
      <% end %>
    </td>
    <td class="button-column">
      <% if can? :update, document %>
        <% if document.draft? %>
          <% if controller_name == 'anthologies' %>
            <%= link_to 'Edit', edit_anthology_document_path(document.anthology.friendly_id,document.friendly_id), :class => 'btn btn-default btn-sm', data: { toggle: 'tooltip', placement: 'top', original_title: 'Text and Metadata are editable' } %>
          <% else %>
            <%= link_to 'Edit', edit_document_path(document), :class => 'btn btn-default btn-sm', data: { toggle: 'tooltip', placement: 'top', original_title: 'Text and Metadata are editable' } %>
          <% end %>
        <% else %>
          <% if controller_name == 'anthologies' %>
            <%= link_to 'Edit', edit_anthology_document_path(document.anthology.friendly_id,document.friendly_id), :class => 'btn btn-default btn-sm', data: { toggle: 'tooltip', placement: 'top', original_title: 'Only metadata are editable' } %>
          <% else %>
            <%= link_to 'Edit', edit_document_path(document), :class => 'btn btn-default btn-sm', data: { toggle: 'tooltip', placement: 'top', original_title: 'Only metadata are editable' } %>
          <% end %>
        <% end %>
        <% if document.anthology.present? %>
          <%= link_to 'Remove from anthology', { action: :remove_doc, controller: 'anthologies', anthology_id: document.anthology_id, document_id: document.id }, method: :post, :class => 'btn btn-danger btn-sm' %>
      <% end %>
      <% end %>
    </td>
      </tr>
    <% end %>
  <% else %>
    <tr>
      <td colspan="6">No documents to view.</td>
    </tr>
  <% end %></table>
<script type="text/javascript">
  $(function () {
    $('[data-toggle="tooltip"]').tooltip();
  });
</script>
